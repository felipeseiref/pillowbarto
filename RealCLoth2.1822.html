<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=Edge"/>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
  <title>KeyShotXR Scroll Control Revisado</title>
  <style>
    body {
      margin: 0;
      padding: 0;
      background-color: #ffffff;
      /* Hacer altura grande para mucho scroll */
      min-height: 400vh;
    }
    #KeyShotXR {
      position: sticky;
      top: 0;
      width: 100vw;
      height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      background-color: #ffffff;
      z-index: 10;
      overflow: hidden;
    }
    /* Asegurar que el contenedor interno tenga tamaño adecuado */
    #KeyShotXR img {
      max-width: 100%;
      height: auto;
      display: block;
    }
    .content-section {
      width: 100%;
      max-width: 1200px;
      margin: auto;
      padding: 40px 20px;
    }
  </style>

  <script type="text/javascript" src="RealCLoth2.1822/files/KeyShotXR.js"></script>
  <script>
  console.log('keyshotXR typeof:', typeof keyshotXR);
</script>
  <script type="text/javascript">
    var xrInstance;
    // Ajusta este valor si el total de frames es otra cosa:
    var totalFrames = 379;

    function initKeyShotXR() {
      xrInstance = new keyshotXR(
        "KeyShotXR",
        "RealCLoth2.1822",
        497,
        883,
        "#FFFFFF",
        379, 1,
        true, false,
        -0.05, 0.05,
        378, 0,
        1, 1,
        0.96,
        true, false,
        false,
        "png",
        true,
        "LOGO-03-03.png",
        true,
        false, false,
        {}, false
      );
      window.addEventListener('scroll', onScroll);
    }

    function onScroll() {
      if (!xrInstance || !xrInstance.D || !xrInstance.O) return;

      var scrollTop = window.scrollY;
      var maxScroll = document.body.scrollHeight - window.innerHeight;
      var scrollFraction = scrollTop / maxScroll;
      if (scrollFraction < 0) scrollFraction = 0;
      if (scrollFraction > 1) scrollFraction = 1;

      var frameIndex = Math.floor(scrollFraction * (totalFrames - 1));
      // Debugging:
      console.log("scrollFraction:", scrollFraction, "frameIndex:", frameIndex);

      // Cambiar la imagen:
      xrInstance.O.src = xrInstance.D[frameIndex];
    }

    window.onload = initKeyShotXR;
  </script>
</head>
<body oncontextmenu="return false;">
  <div id="KeyShotXR"></div>

  <section class="content-section">
    <h1>Contenido después del XR</h1>
    <p>El visor permanece fijo mientras haces scroll y la animación avanza.</p>
    <p>...</p>
  </section>
</body>
</html>
